import numpy
import sys
import random

numOfTuples = int(sys.argv[1]);
maxkeyval = int(sys.argv[2]);
skew = float(sys.argv[3]);

seed = [1097392880, 1017527545, 1977980431, 534552014, 301049910, 556768788, 1917034035, 1458052470, 32118824, 1835562881, 1619952622, 290185764, 1156525850, 71426927, 1691549729, 1439747482, 2112718571, 2045448316, 55630645, 1197367613, 947335442, 703502809, 1203397333, 35973083, 1490596384, 1286055020, 2079497971, 1182738108, 1567726184, 1040422221, 640645591, \
61394384, 1074234561, 1860870767, 1923543735, 1782688905, 702469582, 1568321667, 1707319006, 1664941835, 743601359, 549394987, 1396336681, 140103800, 152156889, 373054162, \
1355086654, 819787775, 1296358350, 1347428933, 728634982, 858871585, 177926149, 1014758649, 1825515588, 160859170, 316810430, 1274720858, 1142090020, 452674730, 2098634969, 1063201496, 838226614, 1278239725, 1817997985, 180253672, 610595437, 786754353, 1989186444, 1992756693, 1560750333,92176324, 1069849892, 1703453657, 1534344538, 28904460, 2105706437,\
 2121678263, 879625269, 413293888, 852371586, 1958188323, 161145969, 1177794888, 558619473, 890550621, 1664078104, 533628769, 1760920291, 1468826560, 2036266284, 563988443, 1235501192,\
1228430111, 1496522236, 1892631078, 783272197, 1338368962, 1531826287, 92917332, 1316023901, 1053285721, 400221442, 569939073, 891827905, 1321959604, 2077264153, 1842495482, 945926069, 265341929, 93632602, 1893293307, 1801920068, 1387098106, 134973771, 19896844, 974717541, 764017496, 1527703671, 799735772, 621912817, 727976329, 280755621, 1173943828, \
168569562, 1589829944, 1257664501, 762501314, 1466741233, 395565716, 1340261582, 1514991884, 1776651531, 1959267751, 509374451, 2094161505, 1623402479, 1374605095, 921321757, 1079086926, \
1649848663, 1642407022, 1510322421, 1085968012, 487058889, 1589166814, 1897167481, 2016239109, 1528742049, 1934803531, 1159466468, 3473231, 1379475883, 1757996033, 1208511220, 1578501716, 646960421, 1669878443, 863247155, 367538672, 1963797674, 592867643, 1464172398, 199970683,119165824, 702056665, 1212910306, 424409910, 1671322239, 237776743, \
1725265284, 310507587, 1904778678, 1184570177, 1417703160, 36167995, 935722316, 1544056389, 858808717, 532437211, 964166345, 515662958, 1617908698, 130123110, 1781966175, 1531564118, 1952586503, 1003892549, 970271362, 526780076, 1533580650, 1874661274, 784599644, 1272929195, 2000194819, 1335268446, 1434079457, 2038271797, 569495837, 2056708304, \
708049988, 1558275023, 678890706, 1939041492, 1891494357, 102159762, 1247629646, 413196936, 1012582158, 1971372838, 1088854440, 453693829, 1154106581, 445407189, 1195190287, 1899753203, 1294325789, 1405106506, 308930397, 336465616, 934246385, 1546404321, 1660037203, 76976736, 319420565, 83437520, 1257760879, 1942063482, 78685120, 656159738, 1602959546, \
1635981545, 597443718, 1515202476, 579099739, 953461629, 383019310, 1587576769, 1485589421, 464255427, 2123772956, 2005703313, 750496928, 1213375256, 1360263638, 857849277, 232394482, 2131781869, 879405386, 1107476563, 20844818, 219784242, 75160901, 686647770, 1894524871, 194979197, 527244432, 1142492794, 680936305, 68282931, 1996848689, 1289051612, 472631496, \
1140481650, 1917723923, 1672560967, 870269718, 922606505, 305233606, 231111501, 304966594, 108096824, 311361625, 179764215, 520856671, 983143974, 1553695301, 327306947, 1366229163, 1880666186, 1075254307, 895438948, 663119673, 638212385, 1906958434, \
256808182, 109657641, 1976454017, 658932548, 1571010526, 1959079607, 1318688624, 83840754, 915707933, 1028435718, 2008917492, 211149391, 373213756, 489634179, 733387178, 1494416631, 2122415282, 66402283, 1839018925, 1846187944, 1112122361, 1855896900, 1660678426, 681910043, 1950403597, 539406406, 611791103, 676986241, 599186779, 135403880, \
1537572624, 1364044108, 1388414652, 62285955, 709826831, 363205531, 1026991446, 1387619068, 144076082, 1789978065, 528794523, 2112237298, 1061176935, 1317478188, 909338460, 1737695697, 1379432284, 1428448201, 1351918646, 1063079666, 1911527187, 51747456, 988851548, 1034134614, 1771088001, 1692024077, 267228728, 772366974, 954233894, 770624717,\
1615911128, 703920921, 1873817604, 725279111, 164238341, 166671985, 828489794, 164102591, 1185416868, 1745635008, 463810242, 1122101677, 1865227282, 1845670546, 784771020, 2141650985, 268579610, 1637543126, 1497056706, 207210989, 1714917985, 1415494642, 1735791524, 1817353010, 794262142, 926224677, 1753862675, 1417645223, 1638300762, 1429752525, \
638667060, 957109051, 2117271334, 839430088, 1712211207, 2056418941, 1023218246, 161051185, 1674295335, 1352301477, 1295577709, 1336773938, 1740297884, 1517398027,964850440, 1026022630, 562592716, 1282041792, 1872059084, 1159947443, 1121738463, 1039548926, 1512618066, 1011678271, 1885244378, 1179467032, 385732530, 715345559, 2057284672, 958387172, \
388721221, 617937872, 376955019, 61969405, 1637449046, 426993961, 513295090, 1536454283, 1612170047, 964145440, 459822166, 1339818501, 1082101104, 1851550973, 1495257625, 1611754665, 502059148, 1531137178, 323174122, 2052161275, 520137143, 2075585939, 89352432, 333176533, 662836150, 915625565, 810671486, 497573685,1573914446, 1891238834, 390390493, \
685176456, 218438961, 213432107, 257279466, 1464917875, 695747835, 2049047284, 238322150, 818910756, 1973987204, 1597455865, 152377228, 302975766, 387429573, 1902244700, 1105557019, 2068006924, 2039782785, 150213797,185874163, 1168242051, 2055039534, 1497105948, 1515895474, 1246501096, 1346251769, 2053568821, 1615838766, 1221132253, 487981063, 26621861,\
985932904, 2000425361, 1395251921, 807584013, 2132816018, 1556382109, 679743624, 1527332878, 1868340996, 1731032059, 1396322281, 1753305159, 581628098, 43154559, 973453657, 692400013, 1381447042, 1632480931, 149420654, 1795701915, 1495367285, 1398327849, 1980563658, 1899526783, 415019064, 1194761603, 563994558, 588080334, 864158135, 2041700793, 1634047350,\
1093332055, 1510010489, 1419360615, 1115769397, 997418602, 843526126, 1657439031, 1980832026, 1036301740, 1126971848, 859126440, 1547630053, 2081322861, 1112216251, 773015793, 1676414116, 288860419, 990514980, 759548404, 1156832635, 1721034178, 1739037441,70168432, 1111482845, 1760622088, 2015143417, 880572081, 78538789, 1211574048, 648961825, \
604831350, 1994694451, 953880795, 1646730583, 1889769562, 557015060, 1473480310, 1023352388, 1870249072, 2139978373, 1602493234, 1961092594, 1840218078, 999256003, 285428720, 1563740514, 765495333, 968714645, 1794194510, 637519322, 1047455843, 1082268140, 1938102232, 485995153, 383535584, 1441006711, 1752570028, 1548486413, 248385144, \
793206733, 1889620591, 801994488, 1447558345, 1306681180, 1617640563, 1912437435, 1467280505, 1222057900, 1512964763, 820725848, 718110694,1550371652, 1003714032, 1105473977, 175583563, 134922452, 693297061, 1625362624, 1458115977, 805916537, 1468312952, 1359677256, 1650630305, 225276384, 1015892523, 167469205, 1078640699, 731881642, 2120770642, 110345027,\
927426929, 1397654730, 881630883, 1396159793, 817454862, 1440132633, 525273156, 756562288, 472346591, 169944571, 901946895, 857139396, 1799918089, 1184930809, 912934806, 872103955, 1163910017, 457821347, 1981579154, 1120234533, 863709033, 1795893749, 251628880, 221982434, 1313270064, 1138481802, 1203995869, 1680881405, 299957914, 1834827214, 1123285695, 2053875101,\
252046651, 440288873, 463080465, 754057351, 1703698581, 2114277204, 1626453740, 957156360, 1127815117, 1195523136, 1545005503, 563557676, 1196626964, 193011550, 1538727043, 1053323704, 125246322, 270080381, 294780322, 1510905413, 360929564, 601879142, 141148673, 694910124, 757360393, 1347698376, 1889546047, 1641948336, 1424398793, 284390999, 1828079635, 990521074, \
508774053, 1518383414, 922087505, 1319449516, 1403296979, 226208106, 1995570046, 1499242357, 1811054348, 934341574,536064884, 201094945, 272007967, 480781822, 589115308, 324390586, 610397876, 458262282, 506667237, 431498421, 940686278, 1879545580, 486834174, 1385771110, 740884989, 446269114, 1823944301, 1880509117, 1783460294, 1640364604, 1829837465, 986610036, 1318577592, \
696774134, 1682355527, 601528986, 2078477228, 2092131328, 944509070, 2007707124, 843477253, 1978829572, 216019105, 1804403186, 1738858155, 756605857, 2056109993, 822476479, 1851420738, 1935093482, 276218663, 307224604, 1645180227, 668836923, 994414624, 1235287352, 846138795, 681377045, 307706765, 1674171565, 205432438, 1907179950, 1658016691, 2051254558, 1843317778,478847662,\
1191615603, 1398290859, 203628747, 1540663238, 1975249857, 1090564437, 1725978497, 581751465, 648604426, 1196222579, 1661242262, 1031804452, 2098011162, 1988073066, 1328320477, 1468333478, 578986987, 579264643, 1164910622, 261772938, 2068265822, 1367708513, 596841059, 84012854, 815890710, 1124150201, 1937360241, 89934291, 355927287, 1047906801, 1408183820, 1654704216, 232529315,\
1713782904, 92936983, 1182221142, 761062069, 1330403705, 71783765, 861744746, 1967799304, 1750486416, 1387134367, 1853160524, 321440859, 1906947423, 359989429, 733230020, 1381528010, 1200707795, 1433571877, 649751424, 1775826622, 1770154720, 2005640183, 410130080, 692599222, 679249393, 1551367536, 1739129541, 1843921565, 1814164296, 1277306116, 570141664, 59846386, 1712465430,\
801294843, 635034735, 829290400, 1702426396, 1372276995, 66961035, 482150298, 1426713580, 1392125239, 1175793456, 141426824, 196973491, 1597119683, 658500576, 1980199034, 361274093, 1099329204, 637538421, 1175337695, 1381021294, 2031363803, 1245464061, 482678939, 352551670, 816852236, 742378378, 1253592285, 1257336047, 1576524687, 217351632, 744181232, 2117325177, 2126982502, \
634198545, 1677182205, 1506816909, 1985285642, 218101792, 1847015070, 160876978, 1113316284, 858668788, 1021584737, 934947758, 1630727223, 893500055, 936862475, 1703398400, 1373854703, 1395031605, 63801158, 1268230945, 1353612739, 823471638, 1206975278, 154667291, 396158757, 1802515480, 891356543, 1401044841, 1374204790, 2010886024, 250709284, 1656790241, 1526469573, 474136268,\
1606295158, 1962180964, 2017863641, 1279769772, 403613188, 2088412846, 2105761365, 1270645358, 1611243309, 166329686, 718747965, 47093500, 738294294, 2037728555, 404831888, 312541942, 847991845, 662411022, 1826414492, 1059944947, 493899802, 1546169731, 1402341499, 1428535409, 1063290624, 1319079264, 1506110827, 1399955146, 128060663, 1446628629, 1823496003, 1457336853, 1563866321,\
474616498, 1952361176, 893441172, 538051745, 1283279465, 2083712849, 944874987, 28631294, 1745864945, 1886719125, 1136657050, 1506884106, 811194113, 1386839835, 381366157, 328485567, 1631716645, 1125502267, 2021997058, 681765389, 1988687652, 569326303, 1867722682, 1824798686, 1227226975, 669988995, 1876282825, 2013331066, 212866296, 271978404, 567057704, 2137619858, 677321220, 689043632,\
645317513, 904924624, 308413273, 595121532, 1561106912, 67746103, 1257698980, 455367656, 39404627, 1991367127, 599115725, 287925604, 1386789092, 1795508479, 2092463287, 1714167885, 641784185, 472659682, 72463819, 66204117, 1621711079, 819973147, 140210113, 1626141885, 1278146299, 121758552, 1249614054, 580382215, 571849406, 1673653411,221752214, 117094136, 533650362, 360175255, 1894278888,\
479602186, 1114282152, 938799607, 23884428, 1002851259, 2016464834, 1412545419, 1558243571, 722202930, 611488557, 2073394449, 956412860, 1635540851, 116311213, 1426080684, 378677950, 1863136568, 314315749, 1428978561, 1315351956, 1243925944, 686352833, 1349634234, 1318652561, 1360279547, 734331995, 871440819, 1613425365, 1614180233, 1840404676, 507282842, 312870377, 138205146, 2092366018, \
116832133, 1451511246, 357754801, 1355925972, 101462793, 1480565041, 1535264671, 1513215944, 1757561243, 631471277, 255042946, 1133939180, 809339568, 598115842, 1872673749, 800559949, 1384218602, 267583815, 71557288, 1404029699, 333177464, 1568581174, 58149710, 815025150, 1902790674, 737429945, 1174050962,149147791, 1317465713, 1162305076, 1894090844, 421849127, 432850351, 693618202, 804863582, 598836003, 789406714, 2065058094]

if skew > 1:

	for i in range(int(numOfTuples/maxkeyval)):
	    values = numpy.random.zipf(skew, maxkeyval);
	    values = (values-1)%maxkeyval;
	    random.shuffle(values);

	    #keys = random.sample(range(1, (1 << 31)-1), maxkeyval);

	    for i in range(len(values)):
	            print(str(seed[values[i]]) + '|' + str(1));

else:
	for i in range(int(numOfTuples/maxkeyval)):
	    values = list(range(0, maxkeyval));
	    random.shuffle(values);
		
	    #keys=[];
	    #for i in range(maxkeyval):
	    #    keys.append(maxkeyval*seed[i]+i);
	    
	    #keys = random.sample(range(1, (1 << 31)-1), maxkeyval);
	                                                                                                               
	    for i in range(len(values)):
	        print(str(seed[values[i]]) + '|' + str(1));
